{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/kuuku/Desktop/tour-management/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/kuuku/Desktop/tour-management/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"C:/Users/kuuku/Desktop/tour-management/frontend/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"C:/Users/kuuku/Desktop/tour-management/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/kuuku/Desktop/tour-management/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useState}from'react';import'./booking.css';import{Form,FormGroup,ListGroup,ListGroupItem,Button}from'reactstrap';import{useNavigate}from'react-router-dom';import{AuthContext}from\"../../context/AuthContext\";import{BASE_URL}from\"../../utils/config\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Booking=function Booking(_ref){var tour=_ref.tour,avgRating=_ref.avgRating;var price=tour.price,reviews=tour.reviews,title=tour.title;var navigate=useNavigate();var _useContext=useContext(AuthContext),user=_useContext.user;var _useState=useState({userId:user&&user._id,userEmail:user&&user.email,tourName:title,fullName:'',phone:\"\",guestSize:'1',bookAt:''}),_useState2=_slicedToArray(_useState,2),booking=_useState2[0],setBooking=_useState2[1];var handleChange=function handleChange(e){setBooking(function(prev){return _objectSpread(_objectSpread({},prev),{},_defineProperty({},e.target.id,e.target.value));});};var serviceFee=10;var totalAmount=Number(price)*Number(booking.guestSize)+Number(serviceFee);// send data to the server\nvar handleClick=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var res,result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:e.preventDefault();console.log(booking);_context.prev=2;if(!(!user||user===undefined||user===null)){_context.next=5;break;}return _context.abrupt(\"return\",alert('please sign in'));case 5:_context.next=7;return fetch(\"\".concat(BASE_URL,\"/booking\"),{method:'post',headers:{'content-type':'application/json'},credentials:'include',body:JSON.stringify(booking)});case 7:res=_context.sent;_context.next=10;return res.json();case 10:result=_context.sent;if(res.ok){_context.next=13;break;}return _context.abrupt(\"return\",alert(result.message));case 13:navigate('/thank-you');_context.next=19;break;case 16:_context.prev=16;_context.t0=_context[\"catch\"](2);alert(_context.t0.message);case 19:case\"end\":return _context.stop();}},_callee,null,[[2,16]]);}));return function handleClick(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"booking\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"booking__top d-flex align-items-center justify-content-between\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"$\",price,\" \",/*#__PURE__*/_jsx(\"span\",{children:\"/per person\"})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"tour__rating d-flex align-items-center \",children:[/*#__PURE__*/_jsx(\"i\",{className:\"ri-star-s-fill\"}),avgRating===0?null:avgRating,\" (\",reviews===null||reviews===void 0?void 0:reviews.length,\")\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"booking__form\",children:[/*#__PURE__*/_jsx(\"h5\",{children:\"Information\"}),/*#__PURE__*/_jsxs(Form,{className:\"booking__info-form\",onSubmit:handleClick,children:[/*#__PURE__*/_jsx(FormGroup,{children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Full Name\",id:\"fullName\",required:true,onChange:handleChange})}),/*#__PURE__*/_jsx(FormGroup,{children:/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"phone\",id:\"phone\",required:true,onChange:handleChange})}),/*#__PURE__*/_jsxs(FormGroup,{className:\"d-flex align-items-center gap-3 \",children:[/*#__PURE__*/_jsx(\"input\",{type:\"date\",placeholder:\"\",id:\"bookAt\",required:true,onChange:handleChange}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Guest\",id:\"guestSize\",required:true,onChange:handleChange})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"booking__bottom\",children:[/*#__PURE__*/_jsxs(ListGroup,{children:[/*#__PURE__*/_jsxs(ListGroupItem,{className:\"border-0 px-0\",children:[/*#__PURE__*/_jsxs(\"h5\",{className:\"d-flex align-items-center gap-1\",children:[\"$\",price,\" \",/*#__PURE__*/_jsx(\"i\",{className:\"ri-close-line\"}),\"1 person \"]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",price]})]}),/*#__PURE__*/_jsxs(ListGroupItem,{className:\"border-0 px-0\",children:[/*#__PURE__*/_jsx(\"h5\",{children:\"Service charge\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\" $\",serviceFee,\" \"]})]}),/*#__PURE__*/_jsxs(ListGroupItem,{className:\"border-0 px-0 total\",children:[/*#__PURE__*/_jsx(\"h5\",{children:\" Total \"}),/*#__PURE__*/_jsxs(\"span\",{children:[\" $\",totalAmount,\" \"]})]})]}),/*#__PURE__*/_jsx(Button,{className:\"btn primary__btn w-100 mt-4\",onClick:handleClick,children:\"Book Now \"})]})]});};export default Booking;","map":{"version":3,"names":["React","useContext","useState","Form","FormGroup","ListGroup","ListGroupItem","Button","useNavigate","AuthContext","BASE_URL","Booking","tour","avgRating","price","reviews","title","navigate","user","userId","_id","userEmail","email","tourName","fullName","phone","guestSize","bookAt","booking","setBooking","handleChange","e","prev","target","id","value","serviceFee","totalAmount","Number","handleClick","preventDefault","console","log","undefined","alert","fetch","method","headers","credentials","body","JSON","stringify","res","json","result","ok","message","length"],"sources":["C:/Users/kuuku/Desktop/tour-management/frontend/src/components/Booking/Booking.jsx"],"sourcesContent":["import React, { useContext, useState } from 'react'\r\nimport './booking.css'\r\nimport { Form, FormGroup, ListGroup, ListGroupItem, Button } from 'reactstrap';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport {AuthContext} from \"../../context/AuthContext\"\r\nimport {BASE_URL} from \"../../utils/config\"\r\n\r\n\r\n\r\nconst Booking = ({ tour, avgRating }) => {\r\n\r\n  const { price, reviews,title } = tour;\r\n  const navigate = useNavigate()\r\n\r\n  const {user} = useContext(AuthContext)\r\n  \r\n\r\n  const [booking, setBooking] = useState({\r\n    userId: user && user._id,\r\n    userEmail: user&& user.email,\r\n    tourName:title,\r\n    fullName: '',\r\n    phone: \"\",\r\n    guestSize: '1',\r\n    bookAt: ''\r\n  })\r\n\r\n\r\n  const handleChange = e => {\r\n    setBooking(prev => ({ ...prev, [e.target.id]: e.target.value }))\r\n  };\r\n  const serviceFee = 10;\r\n  const totalAmount = Number(price) * Number(booking.guestSize) + Number(serviceFee);\r\n\r\n  // send data to the server\r\n  const handleClick = async e => {\r\n    e.preventDefault();\r\n\r\n    console.log(booking)\r\n\r\n    try {\r\n       if(!user || user===undefined || user===null){\r\n        return alert('please sign in')\r\n       }\r\n\r\n          const res = await fetch(`${BASE_URL}/booking`,{\r\n            method:'post',\r\n            headers:{\r\n              'content-type':'application/json'\r\n            },\r\n            credentials:'include',\r\n            body:JSON.stringify(booking)\r\n          })\r\n\r\n          const result = await res.json()\r\n          if (!res.ok) {\r\n            return alert (result.message)\r\n          }\r\n          navigate('/thank-you')\r\n    } catch (error) {\r\n      \r\n\r\n      alert(error.message);\r\n    }\r\n\r\n   \r\n\r\n  }\r\n  return (\r\n    <div className='booking'>\r\n      <div className=\"booking__top d-flex align-items-center justify-content-between\">\r\n        <h3>${price} <span>/per person</span></h3>\r\n        <span className=\"tour__rating d-flex align-items-center \">\r\n          <i className=\"ri-star-s-fill\"></i>\r\n          {avgRating === 0 ? null : avgRating} ({reviews?.length})\r\n        </span>\r\n      </div>\r\n\r\n      {/* {================booking form================} */}\r\n\r\n      <div className=\"booking__form\">\r\n        <h5>Information</h5>\r\n        <Form className='booking__info-form' onSubmit={handleClick}>\r\n          <FormGroup>\r\n            <input type='text' placeholder='Full Name' id=\"fullName\" required onChange={handleChange} />\r\n          </FormGroup>\r\n          <FormGroup>\r\n            <input type='number' placeholder='phone' id=\"phone\" required onChange={handleChange} />\r\n          </FormGroup>\r\n          <FormGroup className='d-flex align-items-center gap-3 '>\r\n            <input type='date' placeholder='' id=\"bookAt\" required onChange={handleChange} />\r\n            <input type='number' placeholder='Guest' id=\"guestSize\" required onChange={handleChange} />\r\n          </FormGroup>\r\n        </Form>\r\n      </div>\r\n\r\n      {/* {================booking end================} */}\r\n\r\n      {/* booking bottom */}\r\n      <div className=\"booking__bottom\">\r\n        <ListGroup>\r\n          <ListGroupItem className='border-0 px-0'>\r\n            <h5 className='d-flex align-items-center gap-1'>${price} <i className=\"ri-close-line\"></i>1 person </h5>\r\n            <span>${price}</span>\r\n          </ListGroupItem>\r\n          <ListGroupItem className='border-0 px-0'>\r\n            <h5>Service charge</h5>\r\n            <span> ${serviceFee} </span>\r\n          </ListGroupItem>\r\n          <ListGroupItem className='border-0 px-0 total'>\r\n            <h5> Total </h5>\r\n            <span> ${totalAmount} </span>\r\n          </ListGroupItem>\r\n        </ListGroup>\r\n\r\n        <Button className='btn primary__btn w-100 mt-4' onClick={handleClick}>Book Now </Button>\r\n      </div>\r\n    </div>\r\n  )\r\n};\r\n\r\nexport default Booking"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}